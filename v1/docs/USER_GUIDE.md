# Руководство пользователя csvQuery

## Содержание

1. [Введение](#введение)
2. [Первый запуск](#первый-запуск)
3. [Интерфейс приложения](#интерфейс-приложения)
4. [Работа с файлами](#работа-с-файлами)
5. [SQL редактор](#sql-редактор)
6. [Работа с таблицами](#работа-с-таблицами)
7. [История запросов](#история-запросов)
8. [Экспорт и импорт](#экспорт-и-импорт)
9. [Настройки](#настройки)
10. [Горячие клавиши](#горячие-клавиши)
11. [Решение проблем](#решение-проблем)

## Введение

csvQuery - это мощный инструмент для работы с CSV файлами и выполнения SQL запросов. Приложение позволяет:

- Загружать и редактировать CSV, Excel файлы
- Выполнять SQL запросы к данным
- Группировать и анализировать данные
- Экспортировать результаты в различных форматах
- Сохранять историю запросов

## Первый запуск

### Системные требования
- Windows 10 или новее
- Минимум 4 ГБ оперативной памяти
- 100 МБ свободного места на диске

### Запуск приложения
1. Скачайте исполняемый файл `csvQuery_YYYY-MM-DD_HH-MM.exe`
2. Запустите файл двойным кликом
3. При первом запуске будут созданы конфигурационные файлы

## Интерфейс приложения

### Главное окно
Главное окно состоит из нескольких областей:

- **Панель инструментов** - быстрый доступ к основным функциям
- **Область редактора SQL** - для написания и редактирования запросов
- **Панель таблиц** - отображение загруженных данных
- **История запросов** - дерево сохраненных запросов
- **Панель недавних файлов** - быстрый доступ к недавно открытым файлам

### Вкладки
- **CSV** - работа с табличными данными
- **SQL** - редактор SQL запросов
- **Python** - выполнение Python скриптов
- **AI** - интеграция с ИИ помощником

## Работа с файлами

### Открытие файлов

#### Способы открытия:
1. **Меню File → Open** - стандартный диалог выбора файла
2. **Кнопка "Открыть"** на панели инструментов
3. **Drag & Drop** - перетащите файл в окно приложения
4. **Недавние файлы** - выберите из списка недавно открытых файлов

#### Поддерживаемые форматы:
- **CSV** (.csv) - файлы с разделителями
- **Excel** (.xlsx, .xls) - файлы Microsoft Excel
- **ODS** (.ods) - файлы OpenDocument Spreadsheet
- **ZIP** (.zip) - архивы с сессиями

### Импорт данных

#### Импорт CSV
1. Нажмите **"Import CSV"** или используйте меню **File → Import CSV**
2. Выберите файл в диалоге
3. Настройте параметры импорта:
   - Кодировка (UTF-8, Windows-1251, и др.)
   - Разделитель (запятая, точка с запятой, табуляция)
   - Наличие заголовков
4. Нажмите **"OK"**

#### Импорт Excel
1. Нажмите **"Import Excel"** или используйте меню **File → Import Excel**
2. Выберите файл (.xlsx, .xls, .ods)
3. Выберите лист для импорта (если их несколько)
4. Данные автоматически загрузятся в таблицу

### Недавние файлы

Панель недавних файлов показывает последние 10 открытых файлов:
- **Двойной клик** - открыть файл
- **Серый цвет** - файл недоступен или удален
- **Кнопка "Очистить список"** - удалить все записи

## SQL редактор

### Основные возможности

#### Подсветка синтаксиса
- Автоматическое выделение SQL ключевых слов
- Подсветка строк, чисел, комментариев
- Настраиваемые цветовые схемы

#### Автодополнение
- Предложения SQL ключевых слов
- Автодополнение имен таблиц и колонок
- Подсказки функций

### Написание запросов

#### Базовый синтаксис
```sql
-- Выбор всех данных
SELECT * FROM imported_data;

-- Фильтрация данных
SELECT name, age FROM imported_data WHERE age > 25;

-- Группировка
SELECT department, COUNT(*) as count 
FROM imported_data 
GROUP BY department;
```

#### Параметры запросов
Используйте фигурные скобки для создания параметров:
```sql
SELECT * FROM imported_data WHERE age > {min_age};
```
При выполнении появится диалог для ввода значения параметра.

### Выполнение запросов
1. Напишите SQL запрос в редакторе
2. Нажмите **F7** или кнопку **"Выполнить"**
3. Результат отобразится в новом окне
4. Запрос автоматически сохранится в историю

## Работа с таблицами

### Просмотр данных
- **Прокрутка** - используйте полосы прокрутки или колесо мыши
- **Сортировка** - клик по заголовку колонки
- **Изменение размера колонок** - перетащите границу заголовка

### Редактирование

#### Добавление строк и колонок
- **Ctrl + Plus** - добавить строку/колонку
- **Ctrl + Minus** - удалить строку/колонку
- **Контекстное меню** - правый клик для дополнительных опций

#### Редактирование ячеек
1. Двойной клик по ячейке
2. Введите новое значение
3. Нажмите **Enter** для сохранения

### Поиск и фильтрация

#### Быстрый поиск
1. Нажмите **Ctrl + F**
2. Введите текст для поиска
3. Используйте **F3** для поиска следующего

#### Расширенный поиск
1. Откройте панель расширенного поиска
2. Выберите колонки для поиска
3. Настройте режим поиска:
   - Любое слово
   - Все слова
   - Точное совпадение
   - Регулярное выражение

### Группировка данных
1. Выберите колонку для группировки
2. Правый клик → **"Сгруппировать по значению в колонке"**
3. Данные будут сгруппированы в древовидную структуру
4. Возможна вложенная группировка

### Раскраска таблицы

#### Повторяющиеся значения
- Одинаковые значения в колонке выделяются одним цветом
- Помогает быстро найти дубликаты

#### Переходы между значениями
- Выделяет места смены значений в колонке
- Полезно для анализа последовательностей

## История запросов

### Структура истории
История организована в виде дерева:
- **Группы** - папки для организации запросов
- **Запросы** - сохраненные SQL запросы

### Управление историей

#### Создание групп
1. Правый клик в области истории
2. Выберите **"Добавить группу"**
3. Введите название группы

#### Сохранение запросов
- Запросы автоматически сохраняются при выполнении
- Можно переименовать запрос двойным кликом

#### Организация
- **Drag & Drop** - перетаскивание запросов между группами
- **Переименование** - двойной клик по названию
- **Удаление** - клавиша Delete или контекстное меню

### Загрузка запросов
1. Двойной клик по запросу в истории
2. Запрос загрузится в редактор
3. При изменении будет предложено сохранить

## Экспорт и импорт

### Экспорт данных

#### Экспорт в CSV
1. Выберите данные для экспорта
2. **File → Export CSV** или кнопка на панели
3. Выберите колонки для экспорта
4. Настройте параметры:
   - Разделитель
   - Кодировка
   - Включение заголовков

#### Экспорт в Excel
1. **File → Export Excel** или кнопка **"Save XLSX"**
2. Выберите колонки
3. Файл сохранится с форматированием:
   - Жирные заголовки
   - Автоматическая ширина колонок
   - Сохранение типов данных

### Копирование в буфер обмена
1. Выделите нужные ячейки
2. **Ctrl + C** или контекстное меню
3. Данные скопируются в формате, подходящем для Excel

### Сохранение сессий
Сессия включает:
- Загруженные данные
- Текущий SQL запрос
- Настройки отображения

Сохранение: **File → Save Session**

## Настройки

### Общие настройки
- **Язык интерфейса** - русский/английский
- **Тема оформления** - светлая/темная
- **Автосохранение** - интервал автосохранения

### Настройки редактора
- **Шрифт** - тип и размер шрифта
- **Цветовая схема** - схема подсветки синтаксиса
- **Отступы** - размер табуляции
- **Перенос строк** - автоматический перенос

### Настройки внешнего редактора
- **Путь к редактору** - путь к VSCode или другому редактору
- **Слежение за изменениями** - автообновление при изменении файла

## Горячие клавиши

### Общие
- **Ctrl + O** - открыть файл
- **Ctrl + S** - сохранить
- **Ctrl + N** - новый файл
- **Ctrl + Q** - выход

### SQL редактор
- **F7** - выполнить запрос
- **Ctrl + F** - поиск
- **Ctrl + H** - замена
- **Ctrl + G** - переход к строке
- **Ctrl + /** - комментирование строк
- **Ctrl + \** - добавление/удаление символа |

### Работа с таблицами
- **Ctrl + Plus** - добавить строку/колонку
- **Ctrl + Minus** - удалить строку/колонку
- **Ctrl + C** - копировать
- **Ctrl + V** - вставить
- **Delete** - удалить содержимое ячеек

### Навигация
- **Ctrl + Tab** - переключение между вкладками
- **F3** - найти следующее
- **Shift + F3** - найти предыдущее

## Решение проблем

### Частые проблемы

#### Файл не открывается
1. Проверьте формат файла
2. Убедитесь, что файл не поврежден
3. Попробуйте другую кодировку при импорте CSV

#### Ошибка выполнения SQL
1. Проверьте синтаксис запроса
2. Убедитесь, что таблица `imported_data` существует
3. Проверьте названия колонок

#### Медленная работа
1. Закройте неиспользуемые вкладки
2. Ограничьте количество отображаемых строк
3. Используйте фильтры для уменьшения объема данных

### Сообщения об ошибках

#### "Expecting value line 1 col 1"
- Проблема с форматом JSON файла
- Попробуйте открыть файл как CSV, а не как сессию

#### "File not found"
- Файл был перемещен или удален
- Проверьте путь к файлу
- Удалите файл из списка недавних файлов

### Получение помощи

Если проблема не решается:
1. Проверьте логи приложения
2. Сделайте скриншот ошибки
3. Опишите шаги для воспроизведения
4. Обратитесь к разработчикам

---

**Версия документа**: 1.0  
**Дата обновления**: Январь 2025  
**Применимо к**: csvQuery v1.0+